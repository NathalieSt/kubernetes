apiVersion: v1
data:
  default.conf: "\n        # WebSocket upgrade mapping\n        map $http_upgrade $connection_upgrade {\n            default upgrade;\n            '' close;\n        }\n\n        ## Set a variable to help us decide if we need to add the\n        ## 'Docker-Distribution-Api-Version' header.\n        ## The registry always sets this header.\n        ## In the case of nginx performing auth, the header is unset\n        ## since nginx is auth-ing before proxying.\n        map $upstream_http_docker_distribution_api_version $docker_distribution_api_version {\n            '' 'registry/2.0';\n        }\n\n         \n    upstream jellyfin {\n        server jellyfin.jellyfin.svc.cluster.local:8096;\n    }\n    \n \n    upstream vault {\n        server vault.vault.svc.cluster.local:8200;\n    }\n    \n \n    upstream gatus {\n        server gatus.gatus.svc.cluster.local:80;\n    }\n    \n \n    upstream wikijs {\n        server wikijs.wikijs.svc.cluster.local:80;\n    }\n    \n \n    upstream searxng {\n        server searxng.searxng.svc.cluster.local:8080;\n    }\n    \n \n    upstream dawarich {\n        server dawarich.dawarich.svc.cluster.local:3000;\n    }\n    \n \n    upstream kiali {\n        server kiali.kiali.svc.cluster.local:20001;\n    }\n    \n        server {\n            listen 80;\n            server_name jellyfin.cluster.netbird.selfhosted,vault.cluster.netbird.selfhosted,gatus.cluster.netbird.selfhosted,wikijs.cluster.netbird.selfhosted,searxng.cluster.netbird.selfhosted,dawarich.cluster.netbird.selfhosted,kiali.cluster.netbird.selfhosted;\n            return 301 https://$server_name$request_uri;\n        }\n         \n    server {\n        listen 443 ssl;\n        http2 on;\n        server_name jellyfin.cluster.netbird.selfhosted;\n        \n        ssl_certificate /etc/nginx/ssl/tls.crt;\n        ssl_certificate_key /etc/nginx/ssl/tls.key;\n        \n        # Security headers\n        add_header Strict-Transport-Security \"max-age=63072000\" always;\n        add_header X-Frame-Options DENY;\n        add_header X-Content-Type-Options nosniff;\n        add_header X-XSS-Protection \"1; mode=block\";\n\n        \n            # Increase client body size for file uploads\n            # 0 for unlimited size\n            client_max_body_size 0;\n        \n\n        \n        \n        location / {\n            proxy_pass http://jellyfin;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $server_name;\n            proxy_set_header X-Forwarded-Port $server_port;\n\n            \n            # WebSocket support\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection \"upgrade\";\n\n            # Use the upgrade mapping variable\n            proxy_set_header Connection $connection_upgrade;\n        \n\n            \n        }\n    }\n    \n \n    server {\n        listen 443 ssl;\n        http2 on;\n        server_name vault.cluster.netbird.selfhosted;\n        \n        ssl_certificate /etc/nginx/ssl/tls.crt;\n        ssl_certificate_key /etc/nginx/ssl/tls.key;\n        \n        # Security headers\n        add_header Strict-Transport-Security \"max-age=63072000\" always;\n        add_header X-Frame-Options DENY;\n        add_header X-Content-Type-Options nosniff;\n        add_header X-XSS-Protection \"1; mode=block\";\n\n        \n\n        \n        \n        location / {\n            proxy_pass http://vault;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $server_name;\n            proxy_set_header X-Forwarded-Port $server_port;\n\n            \n\n            \n        }\n    }\n    \n \n    server {\n        listen 443 ssl;\n        http2 on;\n        server_name gatus.cluster.netbird.selfhosted;\n        \n        ssl_certificate /etc/nginx/ssl/tls.crt;\n        ssl_certificate_key /etc/nginx/ssl/tls.key;\n        \n        # Security headers\n        add_header Strict-Transport-Security \"max-age=63072000\" always;\n        add_header X-Frame-Options DENY;\n        add_header X-Content-Type-Options nosniff;\n        add_header X-XSS-Protection \"1; mode=block\";\n\n        \n\n        \n        \n        location / {\n            proxy_pass http://gatus;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $server_name;\n            proxy_set_header X-Forwarded-Port $server_port;\n\n            \n\n            \n        }\n    }\n    \n \n    server {\n        listen 443 ssl;\n        http2 on;\n        server_name wikijs.cluster.netbird.selfhosted;\n        \n        ssl_certificate /etc/nginx/ssl/tls.crt;\n        ssl_certificate_key /etc/nginx/ssl/tls.key;\n        \n        # Security headers\n        add_header Strict-Transport-Security \"max-age=63072000\" always;\n        add_header X-Frame-Options DENY;\n        add_header X-Content-Type-Options nosniff;\n        add_header X-XSS-Protection \"1; mode=block\";\n\n        \n\n        \n        \n        location / {\n            proxy_pass http://wikijs;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $server_name;\n            proxy_set_header X-Forwarded-Port $server_port;\n\n            \n\n            \n        }\n    }\n    \n \n    server {\n        listen 443 ssl;\n        http2 on;\n        server_name searxng.cluster.netbird.selfhosted;\n        \n        ssl_certificate /etc/nginx/ssl/tls.crt;\n        ssl_certificate_key /etc/nginx/ssl/tls.key;\n        \n        # Security headers\n        add_header Strict-Transport-Security \"max-age=63072000\" always;\n        add_header X-Frame-Options DENY;\n        add_header X-Content-Type-Options nosniff;\n        add_header X-XSS-Protection \"1; mode=block\";\n\n        \n\n        \n        \n        location / {\n            proxy_pass http://searxng;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $server_name;\n            proxy_set_header X-Forwarded-Port $server_port;\n\n            \n\n            \n        }\n    }\n    \n \n    server {\n        listen 443 ssl;\n        http2 on;\n        server_name dawarich.cluster.netbird.selfhosted;\n        \n        ssl_certificate /etc/nginx/ssl/tls.crt;\n        ssl_certificate_key /etc/nginx/ssl/tls.key;\n        \n        # Security headers\n        add_header Strict-Transport-Security \"max-age=63072000\" always;\n        add_header X-Frame-Options DENY;\n        add_header X-Content-Type-Options nosniff;\n        add_header X-XSS-Protection \"1; mode=block\";\n\n        \n\n        \n        \n        location / {\n            proxy_pass http://dawarich;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $server_name;\n            proxy_set_header X-Forwarded-Port $server_port;\n\n            \n\n            \n        }\n    }\n    \n \n    server {\n        listen 443 ssl;\n        http2 on;\n        server_name kiali.cluster.netbird.selfhosted;\n        \n        ssl_certificate /etc/nginx/ssl/tls.crt;\n        ssl_certificate_key /etc/nginx/ssl/tls.key;\n        \n        # Security headers\n        add_header Strict-Transport-Security \"max-age=63072000\" always;\n        add_header X-Frame-Options DENY;\n        add_header X-Content-Type-Options nosniff;\n        add_header X-XSS-Protection \"1; mode=block\";\n\n        \n\n        \n        \n        location / {\n            proxy_pass http://kiali;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Host $server_name;\n            proxy_set_header X-Forwarded-Port $server_port;\n\n            \n\n            \n        }\n    }\n    \n    "
kind: ConfigMap
metadata:
  annotations:
    app.kubernetes.io/name: nginx-gateway
  name: nginx-gateway-config
