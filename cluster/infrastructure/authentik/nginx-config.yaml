apiVersion: v1
data:
  default.conf: "                upstream authentik {\n                    server localhost:9000;\n                }\n\n                # HTTP server - redirect to HTTPS\n                server {\n                    listen 80;\n                    server_name authentik.netbird.selfhosted;\n                    return 301 https://$server_name$request_uri;\n                }\n\n                # HTTPS server for Uptime Kuma\n                server {\n                    listen 443 ssl;\n                    http2 on;\n                    server_name authentik.netbird.selfhosted;\n                    \n                    ssl_certificate /etc/nginx/ssl/tls.crt;\n                    ssl_certificate_key /etc/nginx/ssl/tls.key;\n                    \n                    # Security headers\n                    add_header Strict-Transport-Security \"max-age=63072000\" always;\n                    add_header X-Frame-Options DENY;\n                    add_header X-Content-Type-Options nosniff;\n                    add_header X-XSS-Protection \"1; mode=block\";\n                    \n                    location / {\n                        proxy_pass http://authentik;\n                        proxy_set_header Host $host;\n                        proxy_set_header X-Real-IP $remote_addr;\n                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n                        proxy_set_header X-Forwarded-Proto $scheme;\n                        proxy_set_header X-Forwarded-Host $server_name;\n                        proxy_set_header X-Forwarded-Port $server_port;\n                        \n                        # WebSocket support\n                        proxy_http_version 1.1;\n                        proxy_set_header Upgrade $http_upgrade;\n                        proxy_set_header Connection \"upgrade\";\n                    }\n                }\n            \n            "
kind: ConfigMap
metadata:
  name: nginx-config
