---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: caddy
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: caddy
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/caddy
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: csi-driver-nfs
  - name: vault-secrets-operator-config
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: cert-manager
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: cert-manager
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/cert-manager
  prune: true
  wait: true
  timeout: 10m
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: cnpg
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: cnpg-system
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/cnpg
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: csi-driver-nfs
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: csi-driver-nfs
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: csi-driver-nfs
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/csi-driver-nfs
  prune: true
  wait: true
  timeout: 10m
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: forgejo-pg
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: forgejo-pg-cluster
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/postgres/forgejo
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: csi-driver-nfs
  - name: vault-secrets-operator-config
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: gluetun-proxy
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: gluetun-proxy
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/gluetun-proxy
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: vault-secrets-operator-config
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: intel-device-gpu-plugin
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: inteldeviceplugins-system
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/intel-device-plugins/gpu-plugin
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: intel-device-plugins-operator
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: intel-device-plugins-operator
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: inteldeviceplugins-system
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/intel-device-plugins/operator
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: cert-manager
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: keda
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: keda
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/keda
  prune: true
  wait: true
  timeout: 10m
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: main-pg
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: postgres
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/postgres/main
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: csi-driver-nfs
  - name: vault-secrets-operator-config
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: mariadb
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: mariadb
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/mariadb
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: vault-secrets-operator-config
  - name: csi-driver-nfs
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: matrix-pg
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: matrix-pg-cluster
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/postgres/matrix
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: csi-driver-nfs
  - name: vault-secrets-operator-config
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: nfd
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: nfd
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/nfd
  prune: true
  wait: true
  timeout: 10m
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: redis
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: redis
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/redis
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: keda
  - name: csi-driver-nfs
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: reflector
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: reflector
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/reflector
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: keda
  - name: vault-secrets-operator-config
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: valkey
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: valkey
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/valkey
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: keda
  - name: csi-driver-nfs
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: vault
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: vault
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/vault
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: csi-driver-nfs
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: vault-secrets-operator
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: vault-secrets-operator
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/vault-secrets-operator
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: vault
---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: vault-secrets-operator-config
  namespace: flux-system
spec:
  interval: 24h
  targetNamespace: vault-secrets-operator
  sourceRef:
    kind: GitRepository
    name: flux-system
  path: ./cluster/infrastructure/vault-secrets-operator-config
  prune: true
  wait: true
  timeout: 10m
  dependsOn:
  - name: vault-secrets-operator
