---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: elastic-stack
spec:
  interval: 24h
  chartRef:
    kind: HelmChart
    name: elastic-stack-chart
  timeout: 10m
  releaseName: elastic-stack
  install:
    remediation:
      retries: 3
  values:
    eck-elasticsearch:
      enabled: true
      fullnameOverride: elasticsearch
      http:
        tls:
          selfSignedCertificate:
            disabled: true
      nodeSets:
      - config:
          node.store.allow_mmap: false
        count: 1
        name: default
        podTemplate:
          metadata: {}
          spec:
            containers:
            - name: elasticsearch
              resources:
                requests:
                  memory: 2Gi
                limits:
                  memory: 2Gi
        volumeClaimTemplates:
        - metadata:
            name: elasticsearch-data
          spec:
            accessModes:
            - ReadWriteOnce
            resources:
              requests:
                storage: 20Gi
            storageClassName: nfs-remote
    eck-kibana:
      elasticsearchRef:
        name: elasticsearch
      enabled: true
