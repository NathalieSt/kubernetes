---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: elastic-stack-instance
spec:
  interval: 24h
  chartRef:
    kind: HelmChart
    name: elastic-stack-instance-chart
  timeout: 10m
  releaseName: elastic-stack-instance
  install:
    remediation:
      retries: 3
  values:
    eck-beats:
      daemonSet:
        podTemplate:
          spec:
            securityContext:
              runAsUser: 0
      elasticsearchRef:
        name: elasticsearch-es-default
      enabled: true
      kibanaRef:
        name: elastic-stack-instance-eck-kibana-kb
      type: filebeat
    elasticsearch:
      spec:
        nodeSets:
          volumeClaimTemplates:
          - metadata:
              name: elasticsearch-data
            spec:
              accessModes:
              - ReadWriteOnce
              resources:
                requests:
                  storage: 20Gi
              storageClassName: nfs-remote
